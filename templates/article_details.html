{% extends 'base.html' %}
{% load cloudinary %}
{% block title %}{{ post.title_tag }}{% endblock %}


{% block content %}

<h1>{{ post.title }}</h1>
<small>
    By {{post.author}} - {{post.created_on}}
    {% if user.is_authenticated %}
    {% if user.id == post.author.id %}
    - <a href="{% url 'update_post' post.slug %}" class="link-dark fw-bold">Edit</a>
    <a href="{% url 'delete_post' post.slug %}" class="link-dark fw-bold">Delete</a>
    {% endif %}
    {% endif %}
</small>
<hr>
<br>
{{ post.content|safe }}
<div class="image-container">
    <img src=" {{ post.featured_image.url }}" class="img-fluid">
</div>

<br>
<br>
<form action="{% url 'like_post' post.slug %}" method="POST">
    {% csrf_token %}

    {% if user.is_authenticated %}
    {% if liked %}
    <button type="submit" name="post_slug" value="{{ post.slug }}" class="btn btn-danger btn-sm">Unlike</button>
    -
    {{ number_of_likes }} Likes
    {% else %}
    <button type="submit" name="post_slug" value="{{ post.slug }}" class="btn btn-primary btn-sm">Like</button>
    -
    {{ number_of_likes }} Likes
    {% endif %}
    {% else %}
    <small><a href="{% url 'account_login' %}" class="link-dark fw-bold">Login</a> to like</small> -
    {{ number_of_likes }} Likes
    {% endif %}

</form>
<hr>
<h2>Comments</h2>

{% if not post.comments.all %}
No Comments Yet... <a href="{% url 'add_comment' post.slug %}" class="link-dark fw-bold">Post Comment</a>
{% else %}
<a href="{% url 'add_comment' post.slug %}" class="link-dark fw-bold">Post Comment</a>
<br><br>
{% for comment in post.comments.all %}
<strong>
    {{ comment.name }} -
    {{ comment.created_on }}
</strong>
<br>
{{ comment.body }}
<hr>
{% endfor %}
{% endif %}



{% endblock %}